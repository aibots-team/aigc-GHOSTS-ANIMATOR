@model Ghosts.Animator.Api.Infrastructure.Social.SocialGraph
@using Ghosts.Animator
@using Ghosts.Animator.Extensions
@{
    Layout = null;
    var directions = new[] { "&darr;", "&uarr;", "&harr;" };

    string FormatClass(int x)
    {
        if (x<0)
            return $"darr";
        return x == 0 ? "harr" : $"uarr";
    }
    
    string FormatValue(int x)
    {
        if (x<0)
            return $"&darr;{x}";
        return x == 0 ? "&harr;0" : $"&uarr;+{x}";
    }
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Social Graph Detail < GHOSTS ANIMATOR</title>
    <link rel="stylesheet" type="text/css" href="/relationships/inspector.css"/>
    <style>
        .darr {color: red;}
        .uarr {color: green;}
        .harr {color: goldenrod;} 
    </style>
</head>
<body>
<div class="container bootstrap snippet">
    <div class="row">
        <div class="col-sm-12">
            <h1 id="animator-build-relationship">Social Graph Agent Detail</h1>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <img src="/api/npcs/@Model.Id/photo" height="16" width="16" />
            Connections for <strong title="@Model.Id">@Model.Name</strong>:
            <ul>
                @foreach (var connection in Model.Connections)
                {
                    <div>
                        <img src="/api/npcs/@connection.Id/photo" height="16" width="16" alt="thumbnail photo"/>
                        <strong>@connection.Name</strong> / <a href="@connection.Id">Detail</a> / <a href="@connection.Id/interactions">Interactions</a>
                    </div>
                    <div style="margin:0px 0px 20px 20px;">
                        <ul>
                            @foreach (var interaction in connection.Interactions)
                            {
                                <li>Step: @interaction.Step <span class="@Html.Raw(FormatClass(interaction.Value))">(@Html.Raw(FormatValue(interaction.Value)))</span></li>
                                <ul>
                                @foreach (var k in Model.Knowledge.Where(x => x.From == connection.Id && x.Step == interaction.Step))
                                {
                                    var v = FormatValue(k.Value);
                                    <li><span class="@Html.Raw(FormatClass(k.Value))">@k.Topic (@Html.Raw(v))</span></li>
                                }
                                </ul>
                            }
                        </ul>
                    </div>
                }
            </ul>
        </div>
    </div>
</div>
</body>
</html>